<!doctype html>
<html lang="pt-BR">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Simulador de Certificações</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Roboto+Mono:wght@400;500;700&display=swap" rel="stylesheet">
<style>
/* =========================================================
  DESIGN SYSTEM COMPLETO (Tokens CSS)
========================================================= */
:root {
  /* Cores principais */
  --color-primary-50: #eff6ff;
  --color-primary-100: #dbeafe;
  --color-primary-200: #bfdbfe;
  --color-primary-300: #93c5fd;
  --color-primary-400: #60a5fa;
  --color-primary-500: #3b82f6;
  --color-primary-600: #2563eb;
  --color-primary-700: #1d4ed8;
  --color-primary-800: #1e40af;
  --color-primary-900: #1e3a8a;
  
  /* Cores semânticas */
  --color-success: #10b981;
  --color-success-light: #d1fae5;
  --color-warning: #f59e0b;
  --color-warning-light: #fef3c7;
  --color-danger: #ef4444;
  --color-danger-light: #fee2e2;
  --color-info: #3b82f6;
  --color-info-light: #dbeafe;
  
  /* Escala de cinza */
  --color-gray-50: #f9fafb;
  --color-gray-100: #f3f4f6;
  --color-gray-200: #e5e7eb;
  --color-gray-300: #d1d5db;
  --color-gray-400: #9ca3af;
  --color-gray-500: #6b7280;
  --color-gray-600: #4b5563;
  --color-gray-700: #374151;
  --color-gray-800: #1f2937;
  --color-gray-900: #111827;
  
  /* Tokens de espaçamento */
  --space-1: 4px;
  --space-2: 8px;
  --space-3: 12px;
  --space-4: 16px;
  --space-5: 20px;
  --space-6: 24px;
  --space-7: 32px;
  --space-8: 40px;
  --space-9: 48px;
  --space-10: 64px;
  
  /* Tokens de borda */
  --radius-sm: 4px;
  --radius-md: 8px;
  --radius-lg: 12px;
  --radius-xl: 16px;
  --radius-2xl: 24px;
  --radius-full: 9999px;
  
  /* Tokens tipográficos */
  --text-xs: 12px;
  --text-sm: 14px;
  --text-base: 16px;
  --text-lg: 18px;
  --text-xl: 20px;
  --text-2xl: 24px;
  --text-3xl: 30px;
  --text-4xl: 36px;
  
  /* Tokens de sombra */
  --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
  --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1);
  --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1);
  --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.1);
  
  /* Tokens de foco */
  --focus-ring: 0 0 0 3px rgba(59, 130, 246, 0.3);
  
  /* Cores de fundo e superfície */
  --bg-primary: var(--color-gray-50);
  --bg-secondary: var(--color-gray-100);
  --bg-surface: white;
  --bg-overlay: rgba(0, 0, 0, 0.5);
  
  /* Cores de texto */
  --text-primary: var(--color-gray-900);
  --text-secondary: var(--color-gray-600);
  --text-muted: var(--color-gray-500);
  
  /* Bordas */
  --border-light: var(--color-gray-200);
  --border-medium: var(--color-gray-300);
  
  /* Variáveis específicas do layout */
  --max-width: 1200px;
  --header-height: 64px;
  --sidebar-width: 300px;
  --modal-width: 900px;
}

/* =========================================================
  RESET E BASE
========================================================= */
*, *::before, *::after {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

html {
  font-size: 14px;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

body {
  font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
  background-color: var(--bg-primary);
  color: var(--text-primary);
  line-height: 1.5;
  min-height: 100vh;
}

/* =========================================================
  COMPONENTES: BOTÕES
========================================================= */
.btn {
  --btn-bg: var(--bg-surface);
  --btn-border: var(--border-light);
  --btn-color: var(--text-primary);
  --btn-shadow: var(--shadow-sm);
  
  display: inline-flex;
  align-items: center;
  justify-content: center;
  gap: var(--space-2);
  padding: var(--space-3) var(--space-5);
  border-radius: var(--radius-md);
  border: 1px solid var(--btn-border);
  background-color: var(--btn-bg);
  color: var(--btn-color);
  font-family: inherit;
  font-size: var(--text-sm);
  font-weight: 500;
  line-height: 1.25;
  cursor: pointer;
  transition: all 0.2s ease;
  position: relative;
  overflow: hidden;
  white-space: nowrap;
  user-select: none;
  outline: none;
}

.btn:hover:not(:disabled) {
  transform: translateY(-1px);
  box-shadow: var(--shadow-md);
}

.btn:focus-visible {
  box-shadow: var(--focus-ring);
}

.btn:disabled {
  opacity: 0.5;
  cursor: not-allowed;
  transform: none !important;
}

.btn--primary {
  --btn-bg: var(--color-primary-600);
  --btn-border: var(--color-primary-600);
  --btn-color: white;
  --btn-shadow: 0 4px 12px rgba(59, 130, 246, 0.2);
}

.btn--primary:hover:not(:disabled) {
  --btn-bg: var(--color-primary-700);
  --btn-border: var(--color-primary-700);
  box-shadow: 0 6px 20px rgba(59, 130, 246, 0.3);
}

.btn--secondary {
  --btn-bg: var(--color-gray-100);
  --btn-border: var(--color-gray-200);
  --btn-color: var(--color-gray-700);
}

.btn--secondary:hover:not(:disabled) {
  --btn-bg: var(--color-gray-200);
}

.btn--ghost {
  --btn-bg: transparent;
  --btn-border: transparent;
}

.btn--ghost:hover:not(:disabled) {
  --btn-bg: var(--color-gray-100);
}

.btn--danger {
  --btn-bg: var(--color-danger);
  --btn-border: var(--color-danger);
  --btn-color: white;
}

.btn--danger:hover:not(:disabled) {
  --btn-bg: #dc2626;
  --btn-border: #dc2626;
}

.btn--small {
  padding: var(--space-2) var(--space-4);
  font-size: var(--text-xs);
}

.btn--large {
  padding: var(--space-4) var(--space-6);
  font-size: var(--text-base);
}

.btn--loading {
  color: transparent !important;
  pointer-events: none;
}

.btn--loading::after {
  content: '';
  position: absolute;
  width: 16px;
  height: 16px;
  border: 2px solid currentColor;
  border-radius: var(--radius-full);
  border-right-color: transparent;
  animation: spin 1s linear infinite;
}

/* =========================================================
  COMPONENTES: INPUTS
========================================================= */
.form-group {
  display: flex;
  flex-direction: column;
  gap: var(--space-2);
}

.form-label {
  font-size: var(--text-sm);
  font-weight: 500;
  color: var(--text-primary);
}

.form-input {
  width: 100%;
  padding: var(--space-3) var(--space-4);
  border: 1px solid var(--border-light);
  border-radius: var(--radius-md);
  background-color: var(--bg-surface);
  color: var(--text-primary);
  font-family: inherit;
  font-size: var(--text-sm);
  transition: all 0.2s ease;
}

.form-input:hover {
  border-color: var(--color-gray-300);
}

.form-input:focus {
  outline: none;
  border-color: var(--color-primary-500);
  box-shadow: var(--focus-ring);
}

.form-input--error {
  border-color: var(--color-danger);
}

.form-input--error:focus {
  box-shadow: 0 0 0 3px rgba(239, 68, 68, 0.3);
}

.form-helper {
  font-size: var(--text-xs);
  color: var(--text-muted);
  margin-top: var(--space-1);
}

.form-error {
  font-size: var(--text-xs);
  color: var(--color-danger);
  margin-top: var(--space-1);
}

/* =========================================================
  COMPONENTES: CARDS
========================================================= */
.card {
  background-color: var(--bg-surface);
  border-radius: var(--radius-lg);
  border: 1px solid var(--border-light);
  overflow: hidden;
  box-shadow: var(--shadow-sm);
  transition: box-shadow 0.2s ease;
}

.card:hover {
  box-shadow: var(--shadow-md);
}

.card__header {
  padding: var(--space-5);
  border-bottom: 1px solid var(--border-light);
  background-color: var(--bg-surface);
}

.card__body {
  padding: var(--space-5);
}

.card__footer {
  padding: var(--space-5);
  border-top: 1px solid var(--border-light);
  background-color: var(--bg-surface);
}

/* =========================================================
  COMPONENTES: MODAIS
========================================================= */
.modal-overlay {
  position: fixed;
  inset: 0;
  background-color: var(--bg-overlay);
  display: flex;
  align-items: center;
  justify-content: center;
  padding: var(--space-4);
  z-index: 1000;
  opacity: 0;
  visibility: hidden;
  transition: all 0.2s ease;
  backdrop-filter: blur(4px);
}

.modal-overlay--open {
  opacity: 1;
  visibility: visible;
}

.modal {
  width: min(var(--modal-width), 100%);
  max-height: 90vh;
  background-color: var(--bg-surface);
  border-radius: var(--radius-xl);
  box-shadow: var(--shadow-xl);
  overflow: hidden;
  transform: translateY(20px);
  transition: transform 0.3s ease;
}

.modal-overlay--open .modal {
  transform: translateY(0);
}

.modal__header {
  padding: var(--space-6);
  border-bottom: 1px solid var(--border-light);
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: var(--space-4);
}

.modal__title {
  font-size: var(--text-xl);
  font-weight: 600;
  color: var(--text-primary);
}

.modal__close {
  background: none;
  border: none;
  padding: var(--space-2);
  border-radius: var(--radius-md);
  cursor: pointer;
  color: var(--text-muted);
  transition: all 0.2s ease;
}

.modal__close:hover {
  background-color: var(--color-gray-100);
  color: var(--text-primary);
}

.modal__body {
  padding: var(--space-6);
  overflow-y: auto;
  max-height: calc(90vh - 200px);
}

.modal__footer {
  padding: var(--space-6);
  border-top: 1px solid var(--border-light);
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: var(--space-4);
  flex-wrap: wrap;
}

/* =========================================================
  COMPONENTES: LOADING
========================================================= */
.loading {
  display: flex;
  flex-direction: column;
  align-items: center;
  justify-content: center;
  padding: var(--space-10);
  gap: var(--space-4);
}

.loading__spinner {
  width: 40px;
  height: 40px;
  border: 3px solid var(--color-gray-200);
  border-top-color: var(--color-primary-500);
  border-radius: var(--radius-full);
  animation: spin 1s linear infinite;
}

.loading__text {
  font-size: var(--text-sm);
  color: var(--text-muted);
}

.loading-bar {
  width: 100%;
  height: 4px;
  background-color: var(--color-gray-200);
  border-radius: var(--radius-full);
  overflow: hidden;
  position: relative;
}

.loading-bar__fill {
  position: absolute;
  top: 0;
  left: 0;
  height: 100%;
  background: linear-gradient(90deg, var(--color-primary-500), var(--color-primary-400));
  border-radius: var(--radius-full);
  transition: width 0.3s ease;
}

/* =========================================================
  LAYOUT: HEADER
========================================================= */
.header {
  height: var(--header-height);
  background-color: var(--bg-surface);
  border-bottom: 1px solid var(--border-light);
  position: sticky;
  top: 0;
  z-index: 100;
  box-shadow: var(--shadow-sm);
}

.header__inner {
  width: min(var(--max-width), 100% - var(--space-6));
  height: 100%;
  margin: 0 auto;
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: var(--space-6);
}

.header__brand {
  display: flex;
  align-items: center;
  gap: var(--space-3);
  font-weight: 700;
  font-size: var(--text-lg);
  color: var(--color-primary-700);
  text-decoration: none;
}

.header__logo {
  width: 32px;
  height: 32px;
  border-radius: var(--radius-md);
  background: linear-gradient(135deg, var(--color-primary-500), var(--color-primary-600));
  display: flex;
  align-items: center;
  justify-content: center;
  color: white;
  font-weight: 700;
}

.header__nav {
  display: flex;
  gap: var(--space-2);
}

.nav-link {
  padding: var(--space-2) var(--space-4);
  font-size: var(--text-sm);
  font-weight: 500;
  color: var(--text-muted);
  text-decoration: none;
  border-radius: var(--radius-md);
  transition: all 0.2s ease;
  position: relative;
}

.nav-link:hover {
  color: var(--text-primary);
  background-color: var(--color-gray-100);
}

.nav-link--active {
  color: var(--color-primary-600);
  background-color: var(--color-primary-50);
}

.nav-link--active::after {
  content: '';
  position: absolute;
  bottom: -4px;
  left: var(--space-4);
  right: var(--space-4);
  height: 2px;
  background-color: var(--color-primary-600);
  border-radius: var(--radius-full);
}

.header__actions {
  display: flex;
  align-items: center;
  gap: var(--space-4);
}

.user-pill {
  padding: var(--space-2) var(--space-3);
  background-color: var(--color-gray-100);
  border-radius: var(--radius-full);
  font-size: var(--text-sm);
  font-weight: 500;
  color: var(--text-primary);
}

/* =========================================================
  LAYOUT: DASHBOARD
========================================================= */
.main {
  width: min(var(--max-width), 100% - var(--space-6));
  margin: var(--space-6) auto;
  min-height: calc(100vh - var(--header-height) - var(--space-6) * 2);
}

/* Dashboard - KPIs */
.kpi-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
  gap: var(--space-4);
  margin-bottom: var(--space-6);
}

.kpi-card {
  background-color: var(--bg-surface);
  border-radius: var(--radius-lg);
  padding: var(--space-5);
  border: 1px solid var(--border-light);
  box-shadow: var(--shadow-sm);
}

.kpi-card__value {
  font-size: var(--text-3xl);
  font-weight: 700;
  color: var(--text-primary);
  margin-bottom: var(--space-2);
}

.kpi-card__label {
  font-size: var(--text-sm);
  color: var(--text-muted);
  margin-bottom: var(--space-2);
}

.kpi-card__trend {
  display: flex;
  align-items: center;
  gap: var(--space-2);
  font-size: var(--text-xs);
  font-weight: 500;
}

.kpi-card__trend--up {
  color: var(--color-success);
}

.kpi-card__trend--down {
  color: var(--color-danger);
}

/* Dashboard - Seções */
.dashboard-grid {
  display: grid;
  grid-template-columns: 2fr 1fr;
  gap: var(--space-6);
}

@media (max-width: 1024px) {
  .dashboard-grid {
    grid-template-columns: 1fr;
  }
}

.section {
  background-color: var(--bg-surface);
  border-radius: var(--radius-lg);
  border: 1px solid var(--border-light);
  overflow: hidden;
}

.section__header {
  padding: var(--space-5);
  border-bottom: 1px solid var(--border-light);
  background-color: var(--bg-surface);
}

.section__title {
  font-size: var(--text-lg);
  font-weight: 600;
  color: var(--text-primary);
  margin-bottom: var(--space-2);
}

.section__subtitle {
  font-size: var(--text-sm);
  color: var(--text-muted);
}

.section__body {
  padding: var(--space-5);
}

/* Leaderboard */
.leaderboard {
  display: flex;
  flex-direction: column;
  gap: var(--space-3);
}

.leaderboard-item {
  display: flex;
  align-items: center;
  justify-content: space-between;
  padding: var(--space-3);
  border-radius: var(--radius-md);
  background-color: var(--bg-primary);
  transition: background-color 0.2s ease;
}

.leaderboard-item:hover {
  background-color: var(--color-gray-100);
}

.leaderboard-item__name {
  font-weight: 500;
  color: var(--text-primary);
}

.leaderboard-item__stats {
  display: flex;
  align-items: center;
  gap: var(--space-4);
}

.leaderboard-item__value {
  font-weight: 600;
  color: var(--text-primary);
}

.leaderboard-item__trend {
  font-size: var(--text-xs);
  padding: var(--space-1) var(--space-2);
  border-radius: var(--radius-full);
}

.leaderboard-item__trend--up {
  background-color: var(--color-success-light);
  color: var(--color-success);
}

.leaderboard-item__trend--down {
  background-color: var(--color-danger-light);
  color: var(--color-danger);
}

/* Donut Chart Placeholder */
.donut-chart {
  width: 200px;
  height: 200px;
  margin: 0 auto;
  border-radius: var(--radius-full);
  background: conic-gradient(
    var(--color-primary-500) 0% 25%,
    var(--color-success) 25% 50%,
    var(--color-warning) 50% 75%,
    var(--color-danger) 75% 100%
  );
  position: relative;
  display: flex;
  align-items: center;
  justify-content: center;
}

.donut-chart::before {
  content: '';
  position: absolute;
  width: 120px;
  height: 120px;
  background-color: var(--bg-surface);
  border-radius: var(--radius-full);
}

.donut-chart__center {
  position: relative;
  z-index: 1;
  font-weight: 600;
  color: var(--text-primary);
}

/* Gráficos */
.chart-container {
  background-color: var(--bg-surface);
  border-radius: var(--radius-lg);
  border: 1px solid var(--border-light);
  padding: var(--space-5);
  margin-bottom: var(--space-4);
}

.chart-container__header {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: var(--space-4);
}

.chart-container__title {
  font-size: var(--text-base);
  font-weight: 600;
  color: var(--text-primary);
}

.chart-placeholder {
  height: 200px;
  background-color: var(--bg-primary);
  border-radius: var(--radius-md);
  display: flex;
  align-items: center;
  justify-content: center;
  color: var(--text-muted);
  font-size: var(--text-sm);
}

/* =========================================================
  LAYOUT: LOGIN
========================================================= */
.login-container {
  min-height: 100vh;
  display: flex;
  align-items: center;
  justify-content: center;
  padding: var(--space-6);
  background: linear-gradient(135deg, var(--color-primary-50) 0%, var(--bg-primary) 100%);
}

.login-card {
  width: min(900px, 100%);
  display: grid;
  grid-template-columns: 1fr 1fr;
  gap: var(--space-6);
  background-color: var(--bg-surface);
  border-radius: var(--radius-xl);
  overflow: hidden;
  box-shadow: var(--shadow-xl);
}

@media (max-width: 768px) {
  .login-card {
    grid-template-columns: 1fr;
  }
}

.login-card__hero {
  padding: var(--space-8);
  background: linear-gradient(135deg, var(--color-primary-600) 0%, var(--color-primary-800) 100%);
  color: white;
  display: flex;
  flex-direction: column;
  justify-content: center;
}

.login-card__hero-title {
  font-size: var(--text-2xl);
  font-weight: 700;
  margin-bottom: var(--space-4);
  line-height: 1.2;
}

.login-card__hero-text {
  opacity: 0.9;
  line-height: 1.6;
}

.login-card__form {
  padding: var(--space-8);
  display: flex;
  flex-direction: column;
  justify-content: center;
}

.login-card__title {
  font-size: var(--text-xl);
  font-weight: 600;
  color: var(--text-primary);
  margin-bottom: var(--space-2);
}

.login-card__subtitle {
  font-size: var(--text-sm);
  color: var(--text-muted);
  margin-bottom: var(--space-6);
}

/* =========================================================
  LAYOUT: QUIZ
========================================================= */
.quiz-container {
  display: grid;
  grid-template-columns: var(--sidebar-width) 1fr;
  gap: var(--space-6);
  min-height: calc(100vh - var(--header-height) - var(--space-6) * 2);
}

@media (max-width: 1024px) {
  .quiz-container {
    grid-template-columns: 1fr;
  }
}

.quiz-sidebar {
  background-color: var(--bg-surface);
  border-radius: var(--radius-lg);
  border: 1px solid var(--border-light);
  overflow: hidden;
  display: flex;
  flex-direction: column;
  max-height: calc(100vh - var(--header-height) - var(--space-6) * 2);
}

.quiz-sidebar__header {
  padding: var(--space-5);
  border-bottom: 1px solid var(--border-light);
  background-color: var(--bg-surface);
}

.quiz-sidebar__title {
  font-size: var(--text-base);
  font-weight: 600;
  color: var(--text-primary);
  margin-bottom: var(--space-3);
}

.quiz-sidebar__stats {
  display: flex;
  flex-wrap: wrap;
  gap: var(--space-3);
}

.quiz-stat {
  display: flex;
  align-items: center;
  gap: var(--space-2);
  font-size: var(--text-xs);
  color: var(--text-muted);
}

.quiz-stat__value {
  font-weight: 600;
  color: var(--text-primary);
}

.quiz-sidebar__grid {
  padding: var(--space-4);
  display: grid;
  grid-template-columns: repeat(6, 1fr);
  gap: var(--space-2);
  overflow-y: auto;
  flex: 1;
}

.quiz-sidebar__footer {
  padding: var(--space-4);
  border-top: 1px solid var(--border-light);
  display: flex;
  gap: var(--space-2);
  flex-wrap: wrap;
}

.quiz-question-btn {
  aspect-ratio: 1;
  min-height: 44px;
  border: 1px solid var(--border-light);
  border-radius: var(--radius-md);
  background-color: var(--bg-surface);
  color: var(--text-primary);
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s ease;
  display: flex;
  align-items: center;
  justify-content: center;
}

.quiz-question-btn:hover {
  transform: translateY(-1px);
  box-shadow: var(--shadow-sm);
}

.quiz-question-btn--current {
  border-color: var(--color-primary-500);
  box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.2);
  font-weight: 600;
}

.quiz-question-btn--unanswered {
  background-color: var(--bg-surface);
}

.quiz-question-btn--answered {
  background-color: var(--color-primary-50);
  border-color: var(--color-primary-200);
  color: var(--color-primary-600);
}

.quiz-question-btn--correct {
  background-color: var(--color-success-light);
  border-color: var(--color-success);
  color: var(--color-success);
}

.quiz-question-btn--wrong {
  background-color: var(--color-danger-light);
  border-color: var(--color-danger);
  color: var(--color-danger);
}

.quiz-question-btn--blank {
  background-color: var(--color-gray-100);
  color: var(--text-muted);
}

.quiz-legend {
  display: flex;
  align-items: center;
  gap: var(--space-2);
  font-size: var(--text-xs);
  color: var(--text-muted);
  padding: var(--space-1) var(--space-2);
  border-radius: var(--radius-sm);
  background-color: var(--bg-surface);
  border: 1px solid var(--border-light);
}

.quiz-legend__dot {
  width: 8px;
  height: 8px;
  border-radius: var(--radius-full);
}

.quiz-legend__dot--unanswered {
  background-color: var(--color-gray-300);
  border: 1px solid var(--color-gray-400);
}

.quiz-legend__dot--answered {
  background-color: var(--color-primary-400);
}

.quiz-legend__dot--correct {
  background-color: var(--color-success);
}

.quiz-legend__dot--wrong {
  background-color: var(--color-danger);
}

.quiz-main {
  display: flex;
  flex-direction: column;
  gap: var(--space-6);
}

.quiz-header {
  background-color: var(--bg-surface);
  border-radius: var(--radius-lg);
  border: 1px solid var(--border-light);
  padding: var(--space-5);
}

.quiz-header__top {
  display: flex;
  align-items: center;
  justify-content: space-between;
  margin-bottom: var(--space-4);
  flex-wrap: wrap;
  gap: var(--space-4);
}

.quiz-header__progress {
  width: 100%;
  height: 6px;
  background-color: var(--color-gray-200);
  border-radius: var(--radius-full);
  overflow: hidden;
}

.quiz-header__progress-bar {
  height: 100%;
  background: linear-gradient(90deg, var(--color-primary-500), var(--color-primary-400));
  border-radius: var(--radius-full);
  transition: width 0.3s ease;
}

.quiz-counter {
  font-size: var(--text-xl);
  font-weight: 700;
  color: var(--color-primary-600);
}

.quiz-timer {
  font-family: 'Roboto Mono', monospace;
  font-variant-numeric: tabular-nums;
  font-size: var(--text-lg);
  font-weight: 600;
  color: var(--color-primary-600);
  padding: var(--space-2) var(--space-3);
  background-color: var(--color-primary-50);
  border-radius: var(--radius-md);
  border: 1px solid var(--color-primary-200);
}

.quiz-timer--warning {
  color: var(--color-warning);
  background-color: var(--color-warning-light);
  border-color: var(--color-warning);
}

.quiz-timer--danger {
  color: var(--color-danger);
  background-color: var(--color-danger-light);
  border-color: var(--color-danger);
  animation: pulse 1s infinite;
}

.quiz-question {
  background-color: var(--bg-surface);
  border-radius: var(--radius-lg);
  border: 1px solid var(--border-light);
  overflow: hidden;
  flex: 1;
  display: flex;
  flex-direction: column;
}

.quiz-question__header {
  padding: var(--space-5);
  border-bottom: 1px solid var(--border-light);
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: var(--space-4);
  flex-wrap: wrap;
}

.quiz-question__info {
  display: flex;
  align-items: center;
  gap: var(--space-4);
}

.quiz-question__id {
  font-size: var(--text-base);
  font-weight: 600;
  color: var(--color-primary-600);
}

.quiz-question__difficulty {
  padding: var(--space-1) var(--space-3);
  border-radius: var(--radius-full);
  font-size: var(--text-xs);
  font-weight: 600;
  background-color: var(--color-gray-100);
  color: var(--text-muted);
}

.quiz-question__actions {
  display: flex;
  align-items: center;
  gap: var(--space-3);
}

.quiz-question__body {
  padding: var(--space-5);
  flex: 1;
  overflow-y: auto;
}

.quiz-question__text {
  font-size: var(--text-base);
  line-height: 1.6;
  color: var(--text-primary);
  margin-bottom: var(--space-6);
  white-space: pre-wrap;
}

.quiz-options {
  display: flex;
  flex-direction: column;
  gap: var(--space-3);
}

.quiz-option {
  --option-bg: var(--bg-surface);
  --option-border: var(--border-light);
  --option-color: var(--text-primary);
  
  display: flex;
  align-items: flex-start;
  gap: var(--space-4);
  padding: var(--space-4);
  border: 2px solid var(--option-border);
  background-color: var(--option-bg);
  border-radius: var(--radius-lg);
  cursor: pointer;
  transition: all 0.2s ease;
  position: relative;
}

.quiz-option:hover:not(.quiz-option--disabled) {
  border-color: var(--color-primary-300);
  box-shadow: var(--shadow-sm);
}

.quiz-option:focus-within:not(.quiz-option--disabled) {
  border-color: var(--color-primary-500);
  box-shadow: var(--focus-ring);
}

.quiz-option--selected {
  --option-bg: var(--color-primary-50);
  --option-border: var(--color-primary-500);
}

.quiz-option--correct {
  --option-bg: var(--color-success-light);
  --option-border: var(--color-success);
  --option-color: var(--color-success);
}

.quiz-option--wrong {
  --option-bg: var(--color-danger-light);
  --option-border: var(--color-danger);
  --option-color: var(--color-danger);
}

.quiz-option--excluded {
  --option-bg: var(--color-gray-100);
  --option-border: var(--color-gray-300);
  --option-color: var(--text-muted);
  opacity: 0.6;
  text-decoration: line-through;
}

.quiz-option--disabled {
  cursor: not-allowed;
}

.quiz-option__input {
  position: absolute;
  opacity: 0;
  width: 0;
  height: 0;
}

.quiz-option__radio {
  width: 20px;
  height: 20px;
  border: 2px solid var(--color-gray-400);
  border-radius: var(--radius-full);
  flex-shrink: 0;
  margin-top: 2px;
  position: relative;
  transition: all 0.2s ease;
}

.quiz-option__input:checked + .quiz-option__radio {
  border-color: var(--color-primary-500);
  background-color: var(--color-primary-500);
}

.quiz-option__input:checked + .quiz-option__radio::after {
  content: '';
  position: absolute;
  top: 50%;
  left: 50%;
  transform: translate(-50%, -50%);
  width: 8px;
  height: 8px;
  background-color: white;
  border-radius: var(--radius-full);
}

.quiz-option__letter {
  font-weight: 600;
  color: var(--color-primary-600);
  min-width: 24px;
}

.quiz-option__text {
  flex: 1;
  color: var(--option-color);
  line-height: 1.5;
}

.quiz-option__action {
  background: none;
  border: none;
  padding: var(--space-1);
  border-radius: var(--radius-sm);
  cursor: pointer;
  color: var(--text-muted);
  transition: all 0.2s ease;
  flex-shrink: 0;
}

.quiz-option__action:hover {
  background-color: var(--color-gray-100);
  color: var(--text-primary);
}

.quiz-explanation {
  padding: var(--space-5);
  border-top: 1px solid var(--border-light);
  background-color: var(--bg-primary);
  display: none;
}

.quiz-explanation--show {
  display: block;
  animation: slideUp 0.3s ease;
}

.quiz-explanation__title {
  font-size: var(--text-base);
  font-weight: 600;
  color: var(--text-primary);
  margin-bottom: var(--space-3);
}

.quiz-explanation__content {
  line-height: 1.6;
  color: var(--text-primary);
}

.quiz-footer {
  padding: var(--space-5);
  border-top: 1px solid var(--border-light);
  background-color: var(--bg-surface);
  display: flex;
  align-items: center;
  justify-content: space-between;
  gap: var(--space-4);
  flex-wrap: wrap;
}

.quiz-navigation {
  display: flex;
  align-items: center;
  gap: var(--space-3);
}

/* =========================================================
  UTILITÁRIOS
========================================================= */
.text-center { text-align: center; }
.text-left { text-align: left; }
.text-right { text-align: right; }

.text-primary { color: var(--text-primary); }
.text-secondary { color: var(--text-secondary); }
.text-muted { color: var(--text-muted); }
.text-success { color: var(--color-success); }
.text-warning { color: var(--color-warning); }
.text-danger { color: var(--color-danger); }

.font-light { font-weight: 300; }
.font-normal { font-weight: 400; }
.font-medium { font-weight: 500; }
.font-semibold { font-weight: 600; }
.font-bold { font-weight: 700; }

.m-0 { margin: 0; }
.mt-1 { margin-top: var(--space-1); }
.mt-2 { margin-top: var(--space-2); }
.mt-3 { margin-top: var(--space-3); }
.mt-4 { margin-top: var(--space-4); }
.mt-5 { margin-top: var(--space-5); }
.mt-6 { margin-top: var(--space-6); }

.mb-1 { margin-bottom: var(--space-1); }
.mb-2 { margin-bottom: var(--space-2); }
.mb-3 { margin-bottom: var(--space-3); }
.mb-4 { margin-bottom: var(--space-4); }
.mb-5 { margin-bottom: var(--space-5); }
.mb-6 { margin-bottom: var(--space-6); }

.p-0 { padding: 0; }
.p-1 { padding: var(--space-1); }
.p-2 { padding: var(--space-2); }
.p-3 { padding: var(--space-3); }
.p-4 { padding: var(--space-4); }
.p-5 { padding: var(--space-5); }
.p-6 { padding: var(--space-6); }

.gap-1 { gap: var(--space-1); }
.gap-2 { gap: var(--space-2); }
.gap-3 { gap: var(--space-3); }
.gap-4 { gap: var(--space-4); }
.gap-5 { gap: var(--space-5); }
.gap-6 { gap: var(--space-6); }

.hidden { display: none; }
.flex { display: flex; }
.flex-col { flex-direction: column; }
.items-center { align-items: center; }
.justify-between { justify-content: space-between; }
.justify-center { justify-content: center; }

/* =========================================================
  ANIMAÇÕES
========================================================= */
@keyframes spin {
  from { transform: rotate(0deg); }
  to { transform: rotate(360deg); }
}

@keyframes slideUp {
  from {
    opacity: 0;
    transform: translateY(10px);
  }
  to {
    opacity: 1;
    transform: translateY(0);
  }
}

@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}

@keyframes pulse {
  0%, 100% { opacity: 1; }
  50% { opacity: 0.5; }
}

/* =========================================================
  RESPONSIVIDADE
========================================================= */
@media (max-width: 768px) {
  :root {
    --header-height: 56px;
    --sidebar-width: 100%;
  }
  
  .header__inner {
    flex-direction: column;
    height: auto;
    padding: var(--space-3) 0;
  }
  
  .header__nav {
    width: 100%;
    justify-content: center;
    flex-wrap: wrap;
  }
  
  .quiz-container {
    gap: var(--space-4);
  }
  
  .quiz-sidebar {
    max-height: 400px;
    order: 2;
  }
  
  .quiz-sidebar__grid {
    grid-template-columns: repeat(5, 1fr);
  }
  
  .quiz-header__top {
    flex-direction: column;
    align-items: stretch;
  }
  
  .quiz-footer {
    flex-direction: column;
    gap: var(--space-3);
  }
  
  .quiz-navigation {
    width: 100%;
    justify-content: space-between;
  }
  
  .dashboard-grid {
    grid-template-columns: 1fr;
  }
  
  .kpi-grid {
    grid-template-columns: 1fr;
  }
}

@media (max-width: 480px) {
  .quiz-sidebar__grid {
    grid-template-columns: repeat(4, 1fr);
  }
  
  .quiz-question__header {
    flex-direction: column;
    align-items: stretch;
    gap: var(--space-3);
  }
  
  .quiz-question__info {
    justify-content: space-between;
  }
  
  .modal__body {
    padding: var(--space-4);
  }
  
  .modal__footer {
    flex-direction: column;
    align-items: stretch;
  }
}

/* =========================================================
  SCROLLBAR PERSONALIZADA
========================================================= */
::-webkit-scrollbar {
  width: 8px;
  height: 8px;
}

::-webkit-scrollbar-track {
  background: var(--color-gray-100);
  border-radius: var(--radius-full);
}

::-webkit-scrollbar-thumb {
  background: var(--color-gray-300);
  border-radius: var(--radius-full);
}

::-webkit-scrollbar-thumb:hover {
  background: var(--color-gray-400);
}

/* Selection */
::selection {
  background-color: rgba(59, 130, 246, 0.2);
  color: var(--text-primary);
}
</style>
</head>
<body>
<!-- Header/Navigation -->
<header class="header">
  <div class="header__inner">
    <a href="#" class="header__brand">
      <div class="header__logo">Q</div>
      <span>Simulador PQO</span>
    </a>
    
    <nav class="header__nav">
      <a href="#dashboard" class="nav-link nav-link--active" data-view="dashboard">Dashboard</a>
      <a href="#simulado" class="nav-link" data-view="simulado">Simulado</a>
      <a href="#historico" class="nav-link" data-view="historico">Histórico</a>
      <a href="#estatisticas" class="nav-link" data-view="estatisticas">Estatísticas</a>
      <a href="#manuais" class="nav-link" data-view="manuais">Manuais</a>
    </nav>
    
    <div class="header__actions">
      <div class="user-pill" id="userPill">Gustavo</div>
      <button class="btn btn--ghost btn--small" id="logoutBtn">Sair</button>
    </div>
  </div>
</header>

<!-- Views Container -->
<main class="main" id="viewsContainer">
  <!-- Dashboard View -->
  <div class="view view--active" id="dashboardView">
    <div class="mb-6">
      <h1 class="text-3xl font-bold mb-2">Dashboard de Estudos</h1>
      <p class="text-muted">Acompanhe seu progresso e otimize seu plano de estudos</p>
    </div>
    
    <!-- KPIs -->
    <div class="kpi-grid mb-6">
      <div class="kpi-card">
        <div class="kpi-card__value" id="kpiCobertura">72%</div>
        <div class="kpi-card__label">Cobertura do Edital</div>
        <div class="kpi-card__trend kpi-card__trend--up">
          <span>↑ 5%</span>
          <span>última semana</span>
        </div>
      </div>
      
      <div class="kpi-card">
        <div class="kpi-card__value" id="kpiAcerto">68%</div>
        <div class="kpi-card__label">Taxa Média de Acerto</div>
        <div class="kpi-card__trend kpi-card__trend--up">
          <span>↑ 3%</span>
          <span>última semana</span>
        </div>
      </div>
      
      <div class="kpi-card">
        <div class="kpi-card__value" id="kpiTempo">94s</div>
        <div class="kpi-card__label">Tempo Médio por Questão</div>
        <div class="kpi-card__trend kpi-card__trend--down">
          <span>↓ 8s</span>
          <span>última semana</span>
        </div>
      </div>
      
      <div class="kpi-card">
        <div class="kpi-card__value" id="kpiTopicos">3</div>
        <div class="kpi-card__label">Tópicos Críticos (<60%)</div>
        <div class="kpi-card__trend kpi-card__trend--down">
          <span>↓ 2</span>
          <span>última semana</span>
        </div>
      </div>
    </div>
    
    <!-- Main Dashboard Grid -->
    <div class="dashboard-grid mb-6">
      <!-- Leaderboard Section -->
      <div class="section">
        <div class="section__header">
          <h2 class="section__title">Desempenho por Capítulo</h2>
          <p class="section__subtitle">Ordenado por % de acerto</p>
        </div>
        <div class="section__body">
          <div class="leaderboard" id="leaderboardContent">
            <!-- Dinamicamente preenchido -->
          </div>
        </div>
      </div>
      
      <!-- Donut Chart Section -->
      <div class="section">
        <div class="section__header">
          <h2 class="section__title">Distribuição do Tempo</h2>
          <p class="section__subtitle">Tempo de estudo por capítulo</p>
        </div>
        <div class="section__body flex flex-col items-center gap-4">
          <div class="donut-chart">
            <div class="donut-chart__center">100h</div>
          </div>
          <div class="text-center">
            <div class="font-semibold text-primary mb-1">⚠️ Atenção</div>
            <div class="text-sm text-muted">Peso da prova ≠ tempo estudado</div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Charts -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
      <div class="chart-container">
        <div class="chart-container__header">
          <h3 class="chart-container__title">Evolução de % de Acerto</h3>
          <div class="flex gap-2">
            <button class="btn btn--ghost btn--small active">7 dias</button>
            <button class="btn btn--ghost btn--small">30 dias</button>
            <button class="btn btn--ghost btn--small">Total</button>
          </div>
        </div>
        <div class="chart-placeholder">
          Gráfico de linha - Evolução de acerto
        </div>
      </div>
      
      <div class="chart-container">
        <div class="chart-container__header">
          <h3 class="chart-container__title">Tempo Médio por Capítulo</h3>
          <div class="flex gap-2">
            <button class="btn btn--ghost btn--small active">Tempo</button>
            <button class="btn btn--ghost btn--small">Acerto</button>
          </div>
        </div>
        <div class="chart-placeholder">
          Gráfico de barras - Tempo por capítulo
        </div>
      </div>
    </div>
  </div>
  
  <!-- Simulado View -->
  <div class="view" id="simuladoView">
    <!-- Será preenchido dinamicamente -->
  </div>
  
  <!-- Histórico View -->
  <div class="view" id="historicoView">
    <div class="mb-6">
      <h1 class="text-3xl font-bold mb-2">Histórico de Simulados</h1>
      <p class="text-muted">Revise seus simulados anteriores e acompanhe o progresso</p>
    </div>
    <!-- Será preenchido dinamicamente -->
  </div>
  
  <!-- Estatísticas View -->
  <div class="view" id="estatisticasView">
    <div class="mb-6">
      <h1 class="text-3xl font-bold mb-2">Estatísticas Detalhadas</h1>
      <p class="text-muted">Análise avançada do seu desempenho</p>
    </div>
    <!-- Será preenchido dinamicamente -->
  </div>
  
  <!-- Manuais View -->
  <div class="view" id="manuaisView">
    <div class="mb-6">
      <h1 class="text-3xl font-bold mb-2">Manuais e Materiais</h1>
      <p class="text-muted">Acesse materiais oficiais para estudo</p>
    </div>
    <!-- Será preenchido dinamicamente -->
  </div>
</main>

<!-- Login Modal -->
<div class="modal-overlay modal-overlay--open" id="loginModal">
  <div class="modal" style="max-width: 500px;">
    <div class="modal__body">
      <div class="text-center mb-6">
        <h2 class="modal__title mb-2">Bem-vindo ao Simulador PQO</h2>
        <p class="text-muted">Prepare-se para a certificação com questões atualizadas e simulados personalizados</p>
      </div>
      
      <form id="loginForm" class="flex flex-col gap-4">
        <div class="form-group">
          <label for="loginEmail" class="form-label">E-mail</label>
          <input type="email" id="loginEmail" class="form-input" placeholder="seu@email.com" required>
          <div class="form-helper">Use qualquer e-mail para teste</div>
        </div>
        
        <div class="form-group">
          <label for="loginPassword" class="form-label">Senha</label>
          <input type="password" id="loginPassword" class="form-input" placeholder="••••••••" required>
          <div class="form-helper">Qualquer senha funciona no modo demo</div>
        </div>
        
        <div class="flex items-center gap-2 mb-4">
          <input type="checkbox" id="rememberMe" class="form-checkbox">
          <label for="rememberMe" class="text-sm">Lembrar de mim</label>
        </div>
        
        <button type="submit" class="btn btn--primary btn--large" id="loginSubmitBtn">
          <span>Entrar no Simulador</span>
        </button>
        
        <div class="text-center mt-4">
          <p class="text-sm text-muted">Primeiro acesso? Qualquer credencial funciona no modo demo.</p>
        </div>
      </form>
    </div>
  </div>
</div>

<!-- Wizard Modal -->
<div class="modal-overlay" id="wizardModal">
  <div class="modal">
    <div class="modal__header">
      <h2 class="modal__title" id="wizardTitle">Configurar Simulado</h2>
      <button class="modal__close" id="wizardCloseBtn">✕</button>
    </div>
    
    <div class="modal__body">
      <!-- Steps -->
      <div class="flex items-center justify-between mb-6">
        <div class="flex flex-col items-center">
          <div class="w-8 h-8 rounded-full bg-primary-500 text-white flex items-center justify-center font-semibold">1</div>
          <span class="text-xs mt-1">Modalidade</span>
        </div>
        <div class="flex-1 h-1 bg-gray-200 mx-2"></div>
        <div class="flex flex-col items-center">
          <div class="w-8 h-8 rounded-full bg-gray-200 text-gray-500 flex items-center justify-center font-semibold">2</div>
          <span class="text-xs mt-1">Configurações</span>
        </div>
        <div class="flex-1 h-1 bg-gray-200 mx-2"></div>
        <div class="flex flex-col items-center">
          <div class="w-8 h-8 rounded-full bg-gray-200 text-gray-500 flex items-center justify-center font-semibold">3</div>
          <span class="text-xs mt-1">Filtros</span>
        </div>
        <div class="flex-1 h-1 bg-gray-200 mx-2"></div>
        <div class="flex flex-col items-center">
          <div class="w-8 h-8 rounded-full bg-gray-200 text-gray-500 flex items-center justify-center font-semibold">4</div>
          <span class="text-xs mt-1">Revisão</span>
        </div>
      </div>
      
      <!-- Step 1: Modalidade -->
      <div class="wizard-step wizard-step--active" id="wizardStep1">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div class="card cursor-pointer" data-mode="prova">
            <div class="card__body">
              <h3 class="font-semibold text-lg mb-2">Modo Prova</h3>
              <p class="text-muted text-sm mb-4">60 questões • 3 horas • Simulado completo</p>
              <ul class="text-sm text-muted space-y-1">
                <li>✓ Duração oficial</li>
                <li>✓ Limite de tempo</li>
                <li>✓ Experiência real</li>
              </ul>
            </div>
          </div>
          
          <div class="card cursor-pointer" data-mode="personalizado">
            <div class="card__body">
              <h3 class="font-semibold text-lg mb-2">Personalizado</h3>
              <p class="text-muted text-sm mb-4">Configure quantidade e filtros</p>
              <ul class="text-sm text-muted space-y-1">
                <li>✓ Escolha a quantidade</li>
                <li>✓ Filtros avançados</li>
                <li>✓ Foco em tópicos específicos</li>
              </ul>
            </div>
          </div>
        </div>
      </div>
      
      <!-- Step 2: Configurações -->
      <div class="wizard-step hidden" id="wizardStep2">
        <div class="space-y-4">
          <div class="form-group">
            <label for="questionCount" class="form-label">Quantidade de Questões</label>
            <select id="questionCount" class="form-input">
              <option value="10">10 questões (rápido)</option>
              <option value="20">20 questões</option>
              <option value="30">30 questões</option>
              <option value="40">40 questões</option>
              <option value="50">50 questões</option>
              <option value="60">60 questões (prova completa)</option>
            </select>
          </div>
          
          <div class="form-group">
            <label for="timeLimit" class="form-label">Limite de Tempo</label>
            <select id="timeLimit" class="form-input">
              <option value="0">Sem limite</option>
              <option value="180">3 horas (prova oficial)</option>
              <option value="60">1 hora</option>
              <option value="30">30 minutos</option>
            </select>
          </div>
        </div>
      </div>
      
      <!-- Step 3: Filtros -->
      <div class="wizard-step hidden" id="wizardStep3">
        <div class="space-y-4">
          <div class="form-group">
            <label class="form-label">Módulos</label>
            <div class="flex flex-wrap gap-2">
              <button type="button" class="btn btn--ghost btn--small filter-chip" data-filter="modulo" value="1">Título I</button>
              <button type="button" class="btn btn--ghost btn--small filter-chip" data-filter="modulo" value="2">Título II</button>
              <button type="button" class="btn btn--ghost btn--small filter-chip" data-filter="modulo" value="3">Título III</button>
              <button type="button" class="btn btn--ghost btn--small filter-chip" data-filter="modulo" value="4">Título IV</button>
            </div>
          </div>
          
          <div class="form-group">
            <label class="form-label">Dificuldade</label>
            <div class="flex flex-wrap gap-2">
              <button type="button" class="btn btn--ghost btn--small filter-chip" data-filter="dificuldade" value="facil">Fácil</button>
              <button type="button" class="btn btn--ghost btn--small filter-chip" data-filter="dificuldade" value="media">Média</button>
              <button type="button" class="btn btn--ghost btn--small filter-chip" data-filter="dificuldade" value="dificil">Difícil</button>
            </div>
          </div>
          
          <button type="button" class="btn btn--ghost w-full" id="clearFiltersBtn">
            Limpar todos os filtros
          </button>
        </div>
      </div>
      
      <!-- Step 4: Revisão -->
      <div class="wizard-step hidden" id="wizardStep4">
        <div class="card">
          <div class="card__body">
            <h3 class="font-semibold text-lg mb-4">Resumo do Simulado</h3>
            
            <div class="space-y-3">
              <div class="flex justify-between">
                <span class="text-muted">Modalidade:</span>
                <span class="font-semibold" id="reviewMode">—</span>
              </div>
              
              <div class="flex justify-between">
                <span class="text-muted">Quantidade:</span>
                <span class="font-semibold" id="reviewCount">— questões</span>
              </div>
              
              <div class="flex justify-between">
                <span class="text-muted">Duração:</span>
                <span class="font-semibold" id="reviewDuration">—</span>
              </div>
              
              <div class="flex justify-between">
                <span class="text-muted">Filtros aplicados:</span>
                <span class="font-semibold" id="reviewFilters">—</span>
              </div>
              
              <div class="flex justify-between">
                <span class="text-muted">Questões encontradas:</span>
                <span class="font-semibold" id="reviewFound">—</span>
              </div>
            </div>
            
            <div class="mt-6 p-3 bg-primary-50 rounded-lg">
              <p class="text-sm text-primary-700">
                ⚡ Dica: Você pode marcar questões para revisão clicando na estrela (☆) durante a prova.
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <div class="modal__footer">
      <button class="btn btn--ghost" id="wizardPrevBtn" disabled>Voltar</button>
      <button class="btn btn--primary" id="wizardNextBtn">Continuar</button>
    </div>
  </div>
</div>

<!-- Loading Overlay -->
<div class="modal-overlay" id="loadingOverlay">
  <div class="modal" style="max-width: 400px;">
    <div class="modal__body">
      <div class="loading">
        <div class="loading__spinner"></div>
        <div class="loading__text" id="loadingText">Carregando...</div>
        <div class="loading-bar mt-4">
          <div class="loading-bar__fill" id="loadingProgress" style="width: 0%"></div>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
// =========================================================
// SISTEMA DE ESTADO E GERENCIAMENTO
// =========================================================
const AppState = {
  // Estado do usuário
  user: null,
  isAuthenticated: false,
  
  // Estado do curso
  currentCourse: null,
  courses: [],
  questions: [],
  filteredQuestions: [],
  
  // Estado do simulado
  currentSimulation: {
    mode: 'prova', // 'prova' ou 'personalizado'
    config: {},
    questions: [],
    currentIndex: 0,
    answers: {},
    startTime: null,
    timer: null,
    isFinished: false
  },
  
  // Estado da UI
  currentView: 'dashboard',
  isLoading: false,
  loadingProgress: 0
};

// =========================================================
// UTILITÁRIOS
// =========================================================
const Utils = {
  // DOM Helpers
  $(selector) {
    return document.querySelector(selector);
  },
  
  $$(selector) {
    return document.querySelectorAll(selector);
  },
  
  createElement(tag, className, text = '') {
    const el = document.createElement(tag);
    if (className) el.className = className;
    if (text) el.textContent = text;
    return el;
  },
  
  // Formatação
  formatTime(seconds) {
    const hrs = Math.floor(seconds / 3600);
    const mins = Math.floor((seconds % 3600) / 60);
    const secs = seconds % 60;
    
    if (hrs > 0) {
      return `${hrs.toString().padStart(2, '0')}:${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
    }
    return `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
  },
  
  // Storage
  setItem(key, value) {
    try {
      localStorage.setItem(key, JSON.stringify(value));
    } catch (e) {
      console.error('Erro ao salvar no localStorage:', e);
    }
  },
  
  getItem(key, defaultValue = null) {
    try {
      const item = localStorage.getItem(key);
      return item ? JSON.parse(item) : defaultValue;
    } catch (e) {
      console.error('Erro ao ler do localStorage:', e);
      return defaultValue;
    }
  },
  
  // Animação de progresso
  animateProgress(elementId, target, duration = 300) {
    const element = document.getElementById(elementId);
    if (!element) return;
    
    let start = parseFloat(element.style.width) || 0;
    let startTime = null;
    
    function step(timestamp) {
      if (!startTime) startTime = timestamp;
      const progress = Math.min((timestamp - startTime) / duration, 1);
      const current = start + (target - start) * progress;
      element.style.width = `${current}%`;
      
      if (progress < 1) {
        requestAnimationFrame(step);
      }
    }
    
    requestAnimationFrame(step);
  }
};

// =========================================================
// SISTEMA DE AUTENTICAÇÃO
// =========================================================
const Auth = {
  async login(email, password, remember = false) {
    // Em produção, isso seria uma chamada API
    return new Promise((resolve) => {
      setTimeout(() => {
        const user = {
          id: 'user_' + Date.now(),
          email,
          name: email.split('@')[0],
          createdAt: new Date().toISOString()
        };
        
        AppState.user = user;
        AppState.isAuthenticated = true;
        
        Utils.setItem('auth_user', user);
        Utils.setItem('auth_remember', remember);
        
        resolve(user);
      }, 500);
    });
  },
  
  logout() {
    AppState.user = null;
    AppState.isAuthenticated = false;
    localStorage.removeItem('auth_user');
    localStorage.removeItem('auth_remember');
  },
  
  checkAuth() {
    const user = Utils.getItem('auth_user');
    const remember = Utils.getItem('auth_remember', false);
    
    if (user && remember) {
      AppState.user = user;
      AppState.isAuthenticated = true;
      return true;
    }
    
    return false;
  }
};

// =========================================================
// GERENCIADOR DE VIEWS
// =========================================================
const ViewManager = {
  async showView(viewName) {
    // Esconder todas as views
    Utils.$$('.view').forEach(view => {
      view.classList.remove('view--active');
    });
    
    // Atualizar navegação
    Utils.$$('.nav-link').forEach(link => {
      link.classList.remove('nav-link--active');
    });
    
    const navLink = Utils.$(`[data-view="${viewName}"]`);
    if (navLink) {
      navLink.classList.add('nav-link--active');
    }
    
    // Mostrar view solicitada
    const view = Utils.$(`#${viewName}View`);
    if (view) {
      view.classList.add('view--active');
      AppState.currentView = viewName;
      
      // Carregar conteúdo específico da view
      await this.loadViewContent(viewName);
    }
  },
  
  async loadViewContent(viewName) {
    switch (viewName) {
      case 'dashboard':
        await Dashboard.load();
        break;
      case 'simulado':
        await Simulado.load();
        break;
      case 'historico':
        await Historico.load();
        break;
      case 'estatisticas':
        await Estatisticas.load();
        break;
      case 'manuais':
        await Manuais.load();
        break;
    }
  }
};

// =========================================================
// DASHBOARD
// =========================================================
const Dashboard = {
  async load() {
    this.renderKPIs();
    this.renderLeaderboard();
  },
  
  renderKPIs() {
    // Dados simulados - em produção viriam da API
    const kpiData = {
      cobertura: 72,
      acerto: 68,
      tempo: 94,
      topicos: 3
    };
    
    Utils.$('#kpiCobertura').textContent = `${kpiData.cobertura}%`;
    Utils.$('#kpiAcerto').textContent = `${kpiData.acerto}%`;
    Utils.$('#kpiTempo').textContent = `${kpiData.tempo}s`;
    Utils.$('#kpiTopicos').textContent = kpiData.topicos;
  },
  
  renderLeaderboard() {
    const container = Utils.$('#leaderboardContent');
    if (!container) return;
    
    // Dados simulados
    const chapters = [
      { name: 'Mercado de Derivativos', accuracy: 82, questions: 45, trend: 'up' },
      { name: 'Gestão de Risco', accuracy: 75, questions: 32, trend: 'up' },
      { name: 'Renda Fixa', accuracy: 68, questions: 28, trend: 'stable' },
      { name: 'Câmara de Compensação', accuracy: 62, questions: 25, trend: 'down' },
      { name: 'Compliance', accuracy: 58, questions: 18, trend: 'down' }
    ];
    
    container.innerHTML = chapters.map(chapter => `
      <div class="leaderboard-item">
        <div class="leaderboard-item__name">${chapter.name}</div>
        <div class="leaderboard-item__stats">
          <span class="leaderboard-item__value">${chapter.accuracy}%</span>
          <span class="text-muted">${chapter.questions} questões</span>
          <span class="leaderboard-item__trend leaderboard-item__trend--${chapter.trend}">
            ${chapter.trend === 'up' ? '↑' : chapter.trend === 'down' ? '↓' : '→'}
          </span>
        </div>
      </div>
    `).join('');
  }
};

// =========================================================
// GERENCIADOR DE SIMULADO
// =========================================================
const Simulado = {
  async load() {
    if (!AppState.currentSimulation.questions.length) {
      // Mostrar wizard se não houver simulado em andamento
      Wizard.show();
      return;
    }
    
    this.render();
  },
  
  render() {
    const container = Utils.$('#simuladoView');
    if (!container) return;
    
    const sim = AppState.currentSimulation;
    const currentQuestion = sim.questions[sim.currentIndex];
    
    container.innerHTML = `
      <div class="quiz-container">
        <!-- Sidebar -->
        <aside class="quiz-sidebar">
          <div class="quiz-sidebar__header">
            <h3 class="quiz-sidebar__title">Questões</h3>
            <div class="quiz-sidebar__stats">
              <div class="quiz-stat">
                <span>Total:</span>
                <span class="quiz-stat__value">${sim.questions.length}</span>
              </div>
              <div class="quiz-stat">
                <span>Respondidas:</span>
                <span class="quiz-stat__value">${Object.keys(sim.answers).length}</span>
              </div>
            </div>
          </div>
          
          <div class="quiz-sidebar__grid" id="questionGrid">
            <!-- Questões serão renderizadas aqui -->
          </div>
          
          <div class="quiz-sidebar__footer">
            <div class="quiz-legend">
              <div class="quiz-legend__dot quiz-legend__dot--unanswered"></div>
              <span>Não respondida</span>
            </div>
            <div class="quiz-legend">
              <div class="quiz-legend__dot quiz-legend__dot--answered"></div>
              <span>Respondida</span>
            </div>
          </div>
        </aside>
        
        <!-- Main Content -->
        <main class="quiz-main">
          <!-- Header -->
          <header class="quiz-header">
            <div class="quiz-header__top">
              <div class="quiz-counter">${sim.currentIndex + 1}/${sim.questions.length}</div>
              <div class="quiz-timer" id="quizTimer">${Utils.formatTime(sim.config.timeLimit * 60)}</div>
            </div>
            <div class="quiz-header__progress">
              <div class="quiz-header__progress-bar" 
                   style="width: ${((sim.currentIndex + 1) / sim.questions.length) * 100}%"></div>
            </div>
          </header>
          
          <!-- Question -->
          <article class="quiz-question">
            <div class="quiz-question__header">
              <div class="quiz-question__info">
                <span class="quiz-question__id">#${currentQuestion.id}</span>
                <span class="quiz-question__difficulty">${currentQuestion.difficulty}</span>
              </div>
              <div class="quiz-question__actions">
                <button class="btn btn--ghost btn--small" id="starBtn">
                  <span>☆</span>
                  <span>Marcar</span>
                </button>
              </div>
            </div>
            
            <div class="quiz-question__body">
              <div class="quiz-question__text">${currentQuestion.text}</div>
              
              <div class="quiz-options" id="quizOptions">
                <!-- Opções serão renderizadas aqui -->
              </div>
            </div>
            
            <!-- Explanation (hidden by default) -->
            <div class="quiz-explanation" id="quizExplanation">
              <h4 class="quiz-explanation__title">Explicação</h4>
              <div class="quiz-explanation__content">${currentQuestion.explanation}</div>
            </div>
          </article>
          
          <!-- Footer -->
          <footer class="quiz-footer">
            <div class="quiz-navigation">
              <button class="btn btn--ghost" id="prevBtn" ${sim.currentIndex === 0 ? 'disabled' : ''}>
                ← Anterior
              </button>
              <button class="btn btn--primary" id="answerBtn">
                Responder
              </button>
              <button class="btn btn--ghost" id="nextBtn">
                Próxima →
              </button>
            </div>
            
            <button class="btn btn--danger" id="finishBtn">
              Finalizar Simulado
            </button>
          </footer>
        </main>
      </div>
    `;
    
    this.renderQuestionGrid();
    this.renderOptions();
    this.attachEventListeners();
  },
  
  renderQuestionGrid() {
    const container = Utils.$('#questionGrid');
    if (!container) return;
    
    const sim = AppState.currentSimulation;
    
    container.innerHTML = sim.questions.map((q, index) => {
      const answer = sim.answers[q.id];
      let className = 'quiz-question-btn';
      
      if (index === sim.currentIndex) {
        className += ' quiz-question-btn--current';
      }
      
      if (answer) {
        className += answer.isCorrect ? 
          ' quiz-question-btn--correct' : 
          ' quiz-question-btn--wrong';
      } else {
        className += ' quiz-question-btn--unanswered';
      }
      
      return `<button class="${className}" data-index="${index}">${index + 1}</button>`;
    }).join('');
  },
  
  renderOptions() {
    const container = Utils.$('#quizOptions');
    if (!container) return;
    
    const sim = AppState.currentSimulation;
    const currentQuestion = sim.questions[sim.currentIndex];
    const answer = sim.answers[currentQuestion.id];
    
    container.innerHTML = currentQuestion.options.map((option, index) => {
      const letter = String.fromCharCode(65 + index);
      const isSelected = answer && answer.selected === letter;
      const isCorrect = answer && answer.isCorrect && answer.selected === letter;
      const isWrong = answer && !answer.isCorrect && answer.selected === letter;
      
      let className = 'quiz-option';
      if (isSelected) className += ' quiz-option--selected';
      if (isCorrect) className += ' quiz-option--correct';
      if (isWrong) className += ' quiz-option--wrong';
      
      return `
        <label class="${className}" for="option-${letter}">
          <input type="radio" 
                 id="option-${letter}" 
                 name="question-option" 
                 value="${letter}"
                 ${isSelected ? 'checked' : ''}
                 ${answer ? 'disabled' : ''}
                 class="quiz-option__input">
          <div class="quiz-option__radio"></div>
          <div class="quiz-option__letter">${letter}.</div>
          <div class="quiz-option__text">${option}</div>
        </label>
      `;
    }).join('');
  },
  
  attachEventListeners() {
    // Navegação entre questões
    Utils.$('#prevBtn')?.addEventListener('click', () => {
      if (AppState.currentSimulation.currentIndex > 0) {
        AppState.currentSimulation.currentIndex--;
        this.render();
      }
    });
    
    Utils.$('#nextBtn')?.addEventListener('click', () => {
      if (AppState.currentSimulation.currentIndex < AppState.currentSimulation.questions.length - 1) {
        AppState.currentSimulation.currentIndex++;
        this.render();
      }
    });
    
    // Botões de questões na sidebar
    Utils.$$('.quiz-question-btn').forEach(btn => {
      btn.addEventListener('click', () => {
        const index = parseInt(btn.dataset.index);
        AppState.currentSimulation.currentIndex = index;
        this.render();
      });
    });
    
    // Responder questão
    Utils.$('#answerBtn')?.addEventListener('click', () => {
      const selectedOption = Utils.$('input[name="question-option"]:checked');
      if (!selectedOption) {
        alert('Selecione uma alternativa antes de responder.');
        return;
      }
      
      const sim = AppState.currentSimulation;
      const currentQuestion = sim.questions[sim.currentIndex];
      const selectedLetter = selectedOption.value;
      const isCorrect = selectedLetter === currentQuestion.correctAnswer;
      
      sim.answers[currentQuestion.id] = {
        selected: selectedLetter,
        isCorrect,
        answeredAt: new Date().toISOString()
      };
      
      // Mostrar explicação
      Utils.$('#quizExplanation').classList.add('quiz-explanation--show');
      
      // Atualizar UI
      this.renderQuestionGrid();
      this.renderOptions();
      
      // Salvar progresso
      this.saveProgress();
    });
    
    // Finalizar simulado
    Utils.$('#finishBtn')?.addEventListener('click', () => {
      if (confirm('Tem certeza que deseja finalizar o simulado?')) {
        this.finish();
      }
    });
  },
  
  saveProgress() {
    Utils.setItem('current_simulation', AppState.currentSimulation);
  },
  
  async finish() {
    const sim = AppState.currentSimulation;
    sim.isFinished = true;
    sim.finishedAt = new Date().toISOString();
    
    // Calcular resultados
    const total = sim.questions.length;
    const correct = Object.values(sim.answers).filter(a => a.isCorrect).length;
    const accuracy = Math.round((correct / total) * 100);
    
    // Salvar no histórico
    const history = Utils.getItem('simulation_history', []);
    history.unshift({
      id: 'sim_' + Date.now(),
      mode: sim.mode,
      config: sim.config,
      totalQuestions: total,
      correctAnswers: correct,
      accuracy,
      duration: sim.config.timeLimit * 60,
      finishedAt: sim.finishedAt
    });
    
    Utils.setItem('simulation_history', history.slice(0, 50)); // Manter apenas 50
    
    // Limpar simulado atual
    AppState.currentSimulation = {
      mode: 'prova',
      config: {},
      questions: [],
      currentIndex: 0,
      answers: {},
      startTime: null,
      timer: null,
      isFinished: false
    };
    
    // Mostrar resultados
    await Results.show({
      total,
      correct,
      accuracy,
      duration: sim.config.timeLimit * 60
    });
  }
};

// =========================================================
// WIZARD DE CONFIGURAÇÃO
// =========================================================
const Wizard = {
  currentStep: 1,
  config: {
    mode: 'prova',
    questionCount: 60,
    timeLimit: 180, // 3 horas em minutos
    filters: {
      modules: [],
      difficulty: []
    }
  },
  
  show() {
    const modal = Utils.$('#wizardModal');
    if (modal) {
      modal.parentElement.classList.add('modal-overlay--open');
      this.renderStep(1);
    }
  },
  
  hide() {
    const modal = Utils.$('#wizardModal');
    if (modal) {
      modal.parentElement.classList.remove('modal-overlay--open');
    }
  },
  
  renderStep(step) {
    this.currentStep = step;
    
    // Esconder todos os steps
    Utils.$$('.wizard-step').forEach(stepEl => {
      stepEl.classList.add('hidden');
    });
    
    // Mostrar step atual
    const stepEl = Utils.$(`#wizardStep${step}`);
    if (stepEl) {
      stepEl.classList.remove('hidden');
    }
    
    // Atualizar botões
    const prevBtn = Utils.$('#wizardPrevBtn');
    const nextBtn = Utils.$('#wizardNextBtn');
    
    if (prevBtn) {
      prevBtn.disabled = step === 1;
    }
    
    if (nextBtn) {
      nextBtn.textContent = step === 4 ? 'Iniciar Simulado' : 'Continuar';
    }
    
    // Atualizar step indicators
    this.updateStepIndicators(step);
    
    // Carregar conteúdo específico do step
    switch (step) {
      case 1:
        this.renderStep1();
        break;
      case 4:
        this.renderStep4();
        break;
    }
  },
  
  updateStepIndicators(activeStep) {
    const indicators = Utils.$$('.modal__body > .flex > .flex-col');
    indicators.forEach((indicator, index) => {
      const dot = indicator.querySelector('div');
      const stepNumber = index + 1;
      
      if (stepNumber === activeStep) {
        dot.className = 'w-8 h-8 rounded-full bg-primary-500 text-white flex items-center justify-center font-semibold';
      } else if (stepNumber < activeStep) {
        dot.className = 'w-8 h-8 rounded-full bg-primary-100 text-primary-500 flex items-center justify-center font-semibold';
      } else {
        dot.className = 'w-8 h-8 rounded-full bg-gray-200 text-gray-500 flex items-center justify-center font-semibold';
      }
    });
  },
  
  renderStep1() {
    // Configurar seleção de modo
    Utils.$$('[data-mode]').forEach(card => {
      card.classList.remove('border-primary-500', 'ring-2', 'ring-primary-500');
      if (card.dataset.mode === this.config.mode) {
        card.classList.add('border-primary-500', 'ring-2', 'ring-primary-500');
      }
      
      card.addEventListener('click', () => {
        this.config.mode = card.dataset.mode;
        this.renderStep1();
        
        // Se for modo prova, pre-configurar
        if (this.config.mode === 'prova') {
          this.config.questionCount = 60;
          this.config.timeLimit = 180;
          Utils.$('#questionCount').value = '60';
          Utils.$('#timeLimit').value = '180';
        }
      });
    });
  },
  
  renderStep4() {
    // Atualizar resumo
    Utils.$('#reviewMode').textContent = 
      this.config.mode === 'prova' ? 'Modo Prova' : 'Modo Personalizado';
    
    Utils.$('#reviewCount').textContent = 
      `${this.config.questionCount} questões`;
    
    Utils.$('#reviewDuration').textContent = 
      this.config.timeLimit === 0 ? 'Sem limite' : 
      `${this.config.timeLimit} minutos`;
    
    // Calcular questões encontradas (simulado)
    const found = this.config.mode === 'prova' ? 
      60 : Math.min(this.config.questionCount, 45);
    
    Utils.$('#reviewFound').textContent = `${found} questões`;
    
    // Filtros aplicados
    const filters = [];
    if (this.config.filters.modules.length) {
      filters.push(`${this.config.filters.modules.length} módulos`);
    }
    if (this.config.filters.difficulty.length) {
      filters.push(`${this.config.filters.difficulty.length} níveis de dificuldade`);
    }
    
    Utils.$('#reviewFilters').textContent = 
      filters.length ? filters.join(', ') : 'Nenhum';
  },
  
  async startSimulation() {
    // CORREÇÃO DO BUG 1: Prevenir múltiplos cliques
    const nextBtn = Utils.$('#wizardNextBtn');
    if (nextBtn.classList.contains('btn--loading')) {
      return; // Já está processando
    }
    
    // Mostrar loading
    Loading.show('Preparando simulado...');
    
    // Desabilitar botão e mostrar loading
    nextBtn.classList.add('btn--loading');
    nextBtn.disabled = true;
    
    try {
      // Simular carregamento com progresso
      await this.simulateLoading();
      
      // Criar simulado
      const questions = await this.generateQuestions();
      
      // Configurar estado do simulado
      AppState.currentSimulation = {
        mode: this.config.mode,
        config: { ...this.config },
        questions,
        currentIndex: 0,
        answers: {},
        startTime: Date.now(),
        timer: null,
        isFinished: false
      };
      
      // Esconder wizard
      this.hide();
      Loading.hide();
      
      // Navegar para view do simulado
      await ViewManager.showView('simulado');
      
      // Iniciar timer se houver limite
      if (this.config.timeLimit > 0) {
        this.startTimer();
      }
      
    } catch (error) {
      console.error('Erro ao iniciar simulado:', error);
      Loading.hide();
      alert('Erro ao iniciar simulado. Tente novamente.');
    } finally {
      // Reabilitar botão
      nextBtn.classList.remove('btn--loading');
      nextBtn.disabled = false;
    }
  },
  
  async simulateLoading() {
    return new Promise((resolve) => {
      let progress = 0;
      const interval = setInterval(() => {
        progress += Math.random() * 20;
        if (progress >= 90) {
          progress = 90; // Fica em 90% até o carregamento real terminar
        }
        
        Utils.animateProgress('loadingProgress', progress, 200);
        
        Utils.$('#loadingText').textContent = 
          `Carregando... ${Math.round(progress)}%`;
        
        if (progress >= 90) {
          clearInterval(interval);
          
          // Simular conclusão do carregamento
          setTimeout(() => {
            Utils.animateProgress('loadingProgress', 100, 300);
            Utils.$('#loadingText').textContent = 'Concluído!';
            setTimeout(resolve, 500);
          }, 500);
        }
      }, 200);
    });
  },
  
  async generateQuestions() {
    // Em produção, isso buscaria questões de uma API
    // Aqui simulamos geração de questões
    
    return new Promise((resolve) => {
      setTimeout(() => {
        const count = this.config.questionCount;
        const questions = [];
        
        for (let i = 1; i <= count; i++) {
          questions.push({
            id: `Q${i.toString().padStart(3, '0')}`,
            text: `Questão ${i}: Qual é a resposta correta para esta pergunta sobre ${['derivativos', 'risco', 'compliance', 'mercado'][i % 4]}?`,
            difficulty: ['Fácil', 'Média', 'Difícil'][i % 3],
            options: [
              'Alternativa A - Resposta incorreta',
              'Alternativa B - Resposta correta',
              'Alternativa C - Resposta incorreta',
              'Alternativa D - Resposta incorreta',
              'Alternativa E - Resposta incorreta'
            ],
            correctAnswer: 'B',
            explanation: 'Esta é a explicação detalhada da questão, mostrando por que a alternativa B está correta e as outras estão incorretas.'
          });
        }
        
        resolve(questions);
      }, 1000);
    });
  },
  
  startTimer() {
    const limit = this.config.timeLimit * 60; // Converter para segundos
    let remaining = limit;
    
    const timerElement = Utils.$('#quizTimer');
    if (!timerElement) return;
    
    // Atualizar timer a cada segundo
    AppState.currentSimulation.timer = setInterval(() => {
      remaining--;
      
      // Atualizar UI
      if (timerElement) {
        timerElement.textContent = Utils.formatTime(remaining);
        
        // Mudar cores baseado no tempo restante
        if (remaining <= 300) { // 5 minutos
          timerElement.classList.add('quiz-timer--danger');
        } else if (remaining <= 600) { // 10 minutos
          timerElement.classList.add('quiz-timer--warning');
        }
      }
      
      // Tempo esgotado
      if (remaining <= 0) {
        clearInterval(AppState.currentSimulation.timer);
        alert('Tempo esgotado! O simulado será finalizado.');
        Simulado.finish();
      }
    }, 1000);
  }
};

// =========================================================
// HISTÓRICO
// =========================================================
const Historico = {
  async load() {
    const container = Utils.$('#historicoView');
    if (!container) return;
    
    const history = Utils.getItem('simulation_history', []);
    
    if (history.length === 0) {
      container.innerHTML += `
        <div class="card">
          <div class="card__body text-center py-8">
            <h3 class="font-semibold text-lg mb-2">Nenhum simulado encontrado</h3>
            <p class="text-muted mb-4">Complete seu primeiro simulado para ver o histórico.</p>
            <button class="btn btn--primary" id="startFirstSimulado">
              Iniciar Primeiro Simulado
            </button>
          </div>
        </div>
      `;
      
      Utils.$('#startFirstSimulado')?.addEventListener('click', () => {
        Wizard.show();
      });
      
      return;
    }
    
    container.innerHTML += `
      <div class="card">
        <div class="card__body">
          <table class="w-full">
            <thead>
              <tr class="border-b border-gray-200">
                <th class="text-left py-3 px-4 text-sm font-semibold text-gray-600">Data</th>
                <th class="text-left py-3 px-4 text-sm font-semibold text-gray-600">Modalidade</th>
                <th class="text-left py-3 px-4 text-sm font-semibold text-gray-600">Questões</th>
                <th class="text-left py-3 px-4 text-sm font-semibold text-gray-600">Acerto</th>
                <th class="text-left py-3 px-4 text-sm font-semibold text-gray-600">Tempo</th>
                <th class="text-left py-3 px-4 text-sm font-semibold text-gray-600">Ações</th>
              </tr>
            </thead>
            <tbody id="historyTableBody">
              <!-- Preenchido dinamicamente -->
            </tbody>
          </table>
        </div>
      </div>
    `;
    
    this.renderHistoryTable(history);
  },
  
  renderHistoryTable(history) {
    const tbody = Utils.$('#historyTableBody');
    if (!tbody) return;
    
    tbody.innerHTML = history.map(sim => `
      <tr class="border-b border-gray-100 hover:bg-gray-50">
        <td class="py-3 px-4">
          ${new Date(sim.finishedAt).toLocaleDateString('pt-BR')}
        </td>
        <td class="py-3 px-4">
          <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${
            sim.mode === 'prova' ? 
            'bg-primary-100 text-primary-800' : 
            'bg-purple-100 text-purple-800'
          }">
            ${sim.mode === 'prova' ? 'Prova' : 'Personalizado'}
          </span>
        </td>
        <td class="py-3 px-4">${sim.totalQuestions}</td>
        <td class="py-3 px-4">
          <span class="inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ${
            sim.accuracy >= 70 ? 'bg-green-100 text-green-800' :
            sim.accuracy >= 50 ? 'bg-yellow-100 text-yellow-800' :
            'bg-red-100 text-red-800'
          }">
            ${sim.accuracy}%
          </span>
        </td>
        <td class="py-3 px-4">${Utils.formatTime(sim.duration)}</td>
        <td class="py-3 px-4">
          <button class="btn btn--ghost btn--small" data-id="${sim.id}">
            Revisar
          </button>
        </td>
      </tr>
    `).join('');
  }
};

// =========================================================
// ESTATÍSTICAS
// =========================================================
const Estatisticas = {
  async load() {
    const container = Utils.$('#estatisticasView');
    if (!container) return;
    
    container.innerHTML += `
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
        <!-- Exportar Dados -->
        <div class="card">
          <div class="card__body">
            <h3 class="font-semibold text-lg mb-4">Exportar Dados</h3>
            <p class="text-muted mb-4">Exporte seu histórico para análise externa ou backup.</p>
            <div class="flex flex-wrap gap-2">
              <button class="btn btn--secondary" id="exportCSV">CSV</button>
              <button class="btn btn--secondary" id="exportJSON">JSON</button>
              <button class="btn btn--secondary" disabled>PDF (em breve)</button>
            </div>
          </div>
        </div>
        
        <!-- Insights -->
        <div class="card">
          <div class="card__body">
            <h3 class="font-semibold text-lg mb-4">Insights</h3>
            <div class="space-y-3">
              <div class="p-3 bg-yellow-50 rounded-lg">
                <div class="font-semibold text-yellow-800 mb-1">📈 Melhor desempenho</div>
                <div class="text-sm text-yellow-600">Mercado de Derivativos (82% acerto)</div>
              </div>
              <div class="p-3 bg-red-50 rounded-lg">
                <div class="font-semibold text-red-800 mb-1">📉 Maior dificuldade</div>
                <div class="text-sm text-red-600">Compliance (58% acerto)</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    `;
  }
};

// =========================================================
// MANUAIS
// =========================================================
const Manuais = {
  async load() {
    const container = Utils.$('#manuaisView');
    if (!container) return;
    
    container.innerHTML += `
      <div class="card">
        <div class="card__body">
          <h3 class="font-semibold text-lg mb-4">Materiais de Estudo</h3>
          <div class="space-y-4">
            <div class="p-4 border border-gray-200 rounded-lg">
              <div class="flex items-center justify-between mb-2">
                <h4 class="font-semibold">📘 Guia Por Dentro da B3 (2024)</h4>
                <span class="text-xs px-2 py-1 bg-gray-100 rounded">PDF</span>
              </div>
              <p class="text-sm text-muted mb-3">Material oficial atualizado para preparação da certificação PQO.</p>
              <div class="flex gap-2">
                <button class="btn btn--primary btn--small" id="viewManual">Visualizar</button>
                <button class="btn btn--ghost btn--small" id="downloadManual">Baixar</button>
              </div>
            </div>
            
            <div class="p-4 border border-gray-200 rounded-lg">
              <div class="flex items-center justify-between mb-2">
                <h4 class="font-semibold">📊 Análise de Mercado</h4>
                <span class="text-xs px-2 py-1 bg-gray-100 rounded">PDF</span>
              </div>
              <p class="text-sm text-muted mb-3">Dados atualizados do mercado financeiro brasileiro.</p>
              <div class="flex gap-2">
                <button class="btn btn--ghost btn--small" disabled>Em breve</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    `;
  }
};

// =========================================================
// RESULTS MANAGER
// =========================================================
const Results = {
  async show(data) {
    // Em produção, isso mostraria um modal com resultados detalhados
    console.log('Resultados do simulado:', data);
    
    alert(`Simulado finalizado!\n\n` +
          `Acertos: ${data.correct}/${data.total}\n` +
          `Taxa de acerto: ${data.accuracy}%\n` +
          `Duração: ${Utils.formatTime(data.duration)}`);
    
    // Voltar para dashboard
    await ViewManager.showView('dashboard');
  }
};

// =========================================================
// LOADING MANAGER
// =========================================================
const Loading = {
  show(message = 'Carregando...') {
    const overlay = Utils.$('#loadingOverlay');
    const text = Utils.$('#loadingText');
    
    if (overlay && text) {
      text.textContent = message;
      overlay.classList.add('modal-overlay--open');
    }
  },
  
  hide() {
    const overlay = Utils.$('#loadingOverlay');
    if (overlay) {
      overlay.classList.remove('modal-overlay--open');
    }
  }
};

// =========================================================
// INICIALIZAÇÃO DA APLICAÇÃO
// =========================================================
document.addEventListener('DOMContentLoaded', async () => {
  // Configurar event listeners globais
  
  // Login
  Utils.$('#loginForm')?.addEventListener('submit', async (e) => {
    e.preventDefault();
    
    const email = Utils.$('#loginEmail').value;
    const password = Utils.$('#loginPassword').value;
    const remember = Utils.$('#rememberMe').checked;
    
    const submitBtn = Utils.$('#loginSubmitBtn');
    submitBtn.classList.add('btn--loading');
    submitBtn.disabled = true;
    
    try {
      await Auth.login(email, password, remember);
      
      // Esconder modal de login
      Utils.$('#loginModal').classList.remove('modal-overlay--open');
      
      // Atualizar UI
      Utils.$('#userPill').textContent = AppState.user.name;
      
      // Carregar dashboard
      await ViewManager.showView('dashboard');
      
    } catch (error) {
      console.error('Erro no login:', error);
      alert('Erro ao fazer login. Tente novamente.');
    } finally {
      submitBtn.classList.remove('btn--loading');
      submitBtn.disabled = false;
    }
  });
  
  // Logout
  Utils.$('#logoutBtn')?.addEventListener('click', () => {
    Auth.logout();
    location.reload(); // Recarregar página para mostrar login
  });
  
  // Navegação
  Utils.$$('.nav-link').forEach(link => {
    link.addEventListener('click', (e) => {
      e.preventDefault();
      const view = link.dataset.view;
      ViewManager.showView(view);
    });
  });
  
  // Wizard
  Utils.$('#wizardCloseBtn')?.addEventListener('click', () => {
    Wizard.hide();
  });
  
  Utils.$('#wizardPrevBtn')?.addEventListener('click', () => {
    if (Wizard.currentStep > 1) {
      Wizard.renderStep(Wizard.currentStep - 1);
    }
  });
  
  Utils.$('#wizardNextBtn')?.addEventListener('click', async () => {
    if (Wizard.currentStep < 4) {
      // Validar step atual
      if (Wizard.currentStep === 2) {
        // Salvar configurações
        Wizard.config.questionCount = parseInt(Utils.$('#questionCount').value);
        Wizard.config.timeLimit = parseInt(Utils.$('#timeLimit').value);
      }
      
      Wizard.renderStep(Wizard.currentStep + 1);
    } else {
      // Último step - iniciar simulado
      await Wizard.startSimulation();
    }
  });
  
  // Filtros (chips)
  Utils.$$('.filter-chip').forEach(chip => {
    chip.addEventListener('click', () => {
      chip.classList.toggle('bg-primary-500');
      chip.classList.toggle('text-white');
      
      const filterType = chip.dataset.filter;
      const value = chip.value;
      
      if (chip.classList.contains('bg-primary-500')) {
        if (!Wizard.config.filters[filterType]) {
          Wizard.config.filters[filterType] = [];
        }
        Wizard.config.filters[filterType].push(value);
      } else {
        Wizard.config.filters[filterType] = Wizard.config.filters[filterType]
          .filter(v => v !== value);
      }
    });
  });
  
  // Limpar filtros
  Utils.$('#clearFiltersBtn')?.addEventListener('click', () => {
    Wizard.config.filters = { modules: [], difficulty: [] };
    Utils.$$('.filter-chip').forEach(chip => {
      chip.classList.remove('bg-primary-500', 'text-white');
    });
  });
  
  // Checkar autenticação
  if (Auth.checkAuth()) {
    // Usuário já logado
    Utils.$('#userPill').textContent = AppState.user.name;
    Utils.$('#loginModal').classList.remove('modal-overlay--open');
    await ViewManager.showView('dashboard');
  } else {
    // Mostrar login
    Utils.$('#loginModal').classList.add('modal-overlay--open');
  }
});

// =========================================================
// EXPORTAR FUNÇÕES PARA DEBUG (opcional)
// =========================================================
window.AppState = AppState;
window.Utils = Utils;
window.ViewManager = ViewManager;
</script>
</body>
</html>
